{{ define "main" }}
	{{/* Proxy to the section-specific list template for music */}}
	{{ $ctx := . }}
	{{ with site.GetPage "/music" }}
		{{ template "music-list-proxy" (dict "Section" . "Ctx" $ctx) }}
	{{ end }}
{{ end }}

{{ define "music-list-proxy" }}
<main class="music-page">
	<h1 class="title">{{ .Section.Title }}</h1>
	{{ with .Section.Content }}<div class="intro">{{ . }}</div>{{ end }}
	{{ $pages := .Section.Pages.ByDate.Reverse }}
	{{ if gt (len $pages) 0 }}
		<hr class="dot-sep">
	{{ end }}
	{{ range $i, $p := $pages }}
		<article class="music-post">
			<header>
				<h2 class="title"><a href="{{ $p.RelPermalink }}">{{ $p.Title }}</a></h2>
				<p class="date">{{ $p.Date | time.Format ":date_medium" }}</p>
			</header>
			<section>
			{{ with $p.Params.videos }}
					<div class="video-collage">
						{{ range . }}
							<div class="video-item">
				<div class="yt-lite" data-id="{{ . }}"></div>
							</div>
						{{ end }}
					</div>
				{{ else }}
					{{ $p.Summary }}
				{{ end }}
			</section>
		</article>
		{{ if lt (add $i 1) (len $pages) }}
			<hr class="post-sep">
		{{ end }}
	{{ end }}
</main>
<script src="/js/music-lite.js" defer></script>
{{ end }}
